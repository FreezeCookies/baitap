<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tr·∫Øc nghi·ªám H√≥a h·ªçc - Amine</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .header {
      background: #4361ee;
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    .header h1 {
      margin: 0;
      font-size: 2.1rem;
    }
    .controls {
      text-align: center;
      padding: 20px;
      background: #f8f9fa;
    }
    .toggle-btn {
      padding: 12px 24px;
      font-size: 1.1rem;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      background: #4361ee;
      color: white;
      margin: 0 10px;
    }
    .toggle-btn.active {
      background: #2ecc71;
      font-weight: bold;
    }
    .content {
      padding: 30px;
    }
    .question {
      margin-bottom: 32px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 12px;
      border-left: 5px solid #4361ee;
    }
    .question h3 {
      margin: 0 0 16px 0;
      color: #2f3542;
      font-size: 1.25rem;
    }
    .options label {
      display: block;
      margin: 12px 0;
      padding: 12px 16px;
      background: white;
      border: 2px solid #dfe6e9;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .options label:hover {
      background: #f1f3f5;
      border-color: #a29bfe;
    }
    .options input[type="radio"] {
      margin-right: 12px;
    }
    .correct-selected {
      background: #d4edda !important;
      border-color: #28a745 !important;
      font-weight: bold;
    }
    .wrong-selected {
      background: #f8d7da !important;
      border-color: #dc3545 !important;
    }
    .submit-btn {
      display: block;
      width: 220px;
      margin: 40px auto;
      padding: 16px;
      font-size: 1.3rem;
      font-weight: bold;
      color: white;
      background: #e74c3c;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .submit-btn:hover {
      background: #c0392b;
      transform: translateY(-3px);
    }
    #result {
      margin-top: 40px;
      padding: 30px;
      border-radius: 12px;
      color: white;
      font-size: 1.4rem;
      text-align: center;
      display: none;
    }
    .detail {
      max-width: 700px;
      margin: 20px auto;
      text-align: left;
      background: rgba(255,255,255,0.2);
      padding: 20px;
      border-radius: 12px;
      line-height: 1.8;
    }
    .status {
      text-align: center;
      font-style: italic;
      color: #666;
      margin: 10px 0;
    }
  </style>
</head>
<body>

<div class="container">
  <div class="header">
    <h1>Tr·∫Øc nghi·ªám H√≥a h·ªçc - Amine</h1>
    <p>25 c√¢u h·ªèi tr·∫Øc nghi·ªám</p>
  </div>

  <div class="controls">
    <p class="status" id="status">ƒêang ·ªü ch·∫ø ƒë·ªô: Gi·ªØ nguy√™n th·ª© t·ª± (3 l·∫ßn ƒë·∫ßu)</p>
    <button class="toggle-btn" id="fixedBtn">Gi·ªØ nguy√™n th·ª© t·ª±</button>
    <button class="toggle-btn" id="randomBtn">X√°o tr·ªôn ƒë·ªÅ</button>
  </div>

  <div class="content" id="quiz">
    <!-- C√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c JS inject -->
  </div>

  <button class="submit-btn" onclick="submitQuiz()">N·ªòP B√ÄI</button>

  <div id="result"></div>
</div>

<script>
// Danh s√°ch c√¢u h·ªèi g·ªëc (th·ª© t·ª± c·ªë ƒë·ªãnh)
const originalQuestions = [
  { q: "S·ªë ƒë·ªìng ph√¢n c·∫•u t·∫°o c·ªßa amine b·∫≠c hai ·ª©ng v·ªõi c√¥ng th·ª©c ph√¢n t·ª≠ C‚ÇÑH‚ÇÅ‚ÇÅN l√†", options: ["4", "2", "3", "5"], correct: "2" },
  { q: "Trong c√°c ch·∫•t d∆∞·ªõi ƒë√¢y, ch·∫•t n√†o l√† amine b·∫≠c hai?", options: ["C‚ÇÜH‚ÇÖNH‚ÇÇ", "H‚ÇÇN(CH‚ÇÇ)‚ÇÜNH‚ÇÇ", "CH‚ÇÉCH(CH‚ÇÉ)NH‚ÇÇ", "CH‚ÇÉNHCH‚ÇÉ"], correct: "CH‚ÇÉNHCH‚ÇÉ" },
  { q: "Ch·∫•t n√†o sau ƒë√¢y khi ph·∫£n ·ª©ng v·ªõi dung d·ªãch h·ªón h·ª£p HCl v√† HNO‚ÇÇ ·ªü 0‚Äì5‚ÑÉ t·∫°o ra mu·ªëi diazonium?", options: ["Trimethylamine", "Ethylamine", "Aniline", "Dimethylamine"], correct: "Aniline" },
  { q: "Methylamine c√≥ kh·∫£ nƒÉng t·∫°o ph·ª©c khi t√°c d·ª•ng v·ªõi dung d·ªãch mu·ªëi n√†o sau ƒë√¢y?", options: ["Na‚ÇÇSO‚ÇÑ", "FeCl‚ÇÉ", "CuSO‚ÇÑ", "AlCl‚ÇÉ"], correct: "CuSO‚ÇÑ" },
  { q: "C√¥ng th·ª©c ph√¢n t·ª≠ c·ªßa Amphetamine l√†", options: ["C‚ÇÅ‚ÇÄH‚ÇÅ‚ÇÉN", "C‚ÇâH‚ÇÅ‚ÇÉN", "C‚ÇâH‚ÇÅ‚ÇÇN", "C‚ÇàH‚ÇÅ‚ÇÅN"], correct: "C‚ÇâH‚ÇÅ‚ÇÉN" },
  { q: "Nguy√™n nh√¢n g√¢y n√™n t√≠nh base c·ªßa amine l√†", options: ["do amine tan nhi·ªÅu trong n∆∞·ªõc", "do nguy√™n t·ª≠ N c√≥ ƒë·ªô √¢m l·ªõn n√™n c·∫∑p electron chung c·ªßa nguy√™n t·ª≠ N v√† H b·ªã h√∫t v·ªÅ ph√≠a N", "do ph√¢n t·ª≠ amine b·ªã ph√¢n c·ª±c m·∫°nh", "do nguy√™n t·ª≠ N c√≤n c·∫∑p electron t·ª± do n√™n ph√¢n t·ª≠ amine c√≥ th·ªÉ nh·∫≠n proton"], correct: "do nguy√™n t·ª≠ N c√≤n c·∫∑p electron t·ª± do n√™n ph√¢n t·ª≠ amine c√≥ th·ªÉ nh·∫≠n proton" },
  { q: "Trong ph·∫£n ·ª©ng CH‚ÇÉNH‚ÇÇ + HNO‚ÇÇ ‚Üí CH‚ÇÉOH + N‚ÇÇ + H‚ÇÇO, methylamine ƒë√≥ng vai tr√≤ l√†", options: ["acid", "ch·∫•t kh·ª≠", "base", "ch·∫•t oxi h√≥a"], correct: "ch·∫•t kh·ª≠" },
  { q: "Amine th·ªÉ hi·ªán t√≠nh base khi t√°c d·ª•ng v·ªõi c·∫∑p ch·∫•t n√†o sau ƒë√¢y?", options: ["O‚ÇÇ, CuSO‚ÇÑ", "Cl‚ÇÇ, HCl", "NaNO‚ÇÉ, HCl", "FeCl‚ÇÉ, H‚ÇÇSO‚ÇÑ"], correct: "NaNO‚ÇÉ, HCl" },
  { q: "Cho v√†i gi·ªçt n∆∞·ªõc bromine v√†o dung d·ªãch aniline, l·∫Øc nh·∫π th·∫•y xu·∫•t hi·ªán", options: ["b·ªçt kh√≠", "k·∫øt t·ªßa tr·∫Øng", "dung d·ªãch m√†u xanh", "k·∫øt t·ªßa ƒë·ªè n√¢u"], correct: "b·ªçt kh√≠" },
  { q: "Cho ethylamine t√°c d·ª•ng v·ªõi nitrous acid (·ªü nhi·ªát ƒë·ªô th∆∞·ªùng) t·∫°o th√†nh s·∫£n ph·∫©m h·ªØu c∆° ch√≠nh n√†o sau ƒë√¢y?", options: ["CH‚ÇÉCOOH", "CH‚ÇÉCHO", "CH‚ÇÉCH‚ÇÇOH", "CH‚ÇÉOH"], correct: "CH‚ÇÉCH‚ÇÇOH" },
  { q: "Methylamine ph·∫£n ·ª©ng v·ªõi dung d·ªãch ch·∫•t n√†o sau ƒë√¢y thu ƒë∆∞·ª£c k·∫øt t·ªßa m√†u n√¢u ƒë·ªè?", options: ["K‚ÇÇSO‚ÇÑ", "NaCl", "FeCl‚ÇÉ", "Ba(NO‚ÇÉ)‚ÇÇ"], correct: "FeCl‚ÇÉ" },
  { q: "ƒê·ªÉ kh·ª≠ m√πi tanh c·ªßa c√° tr∆∞·ªõc khi ch·∫ø bi·∫øn th·ª±c ph·∫©m, n√™n √°p d·ª•ng c√°ch n√†o sau ƒë√¢y?", options: ["Ng√¢m c√° trong n∆∞·ªõc ƒë·ªÉ amine tan v√†o n∆∞·ªõc", "R·ª≠a c√° b·∫±ng gi·∫•m ƒÉn", "R·ª≠a c√° b·∫±ng dung d·ªãch soda", "R·ª≠a c√° b·∫±ng dung d·ªãch n∆∞·ªõc mu·ªëi"], correct: "Ng√¢m c√° trong n∆∞·ªõc ƒë·ªÉ amine tan v√†o n∆∞·ªõc" },
  { q: "Trong c√°c ch·∫•t d∆∞·ªõi ƒë√¢y, ch·∫•t n√†o l√† amine b·∫≠c ba?", options: ["(CH‚ÇÉ)‚ÇÉN", "CH‚ÇÉCH‚ÇÇNH‚ÇÇ", "CH‚ÇÉNHCH‚ÇÉ", "C‚ÇÇH‚ÇÖNHCH‚ÇÉ"], correct: "(CH‚ÇÉ)‚ÇÉN" },
  { q: "Ethylamine c√≥ c√¥ng th·ª©c c·∫•u t·∫°o l√†", options: ["CH‚ÇÉNH‚ÇÇ", "(CH‚ÇÉ)‚ÇÉN", "CH‚ÇÉNHCH‚ÇÉ", "C‚ÇÇH‚ÇÖNH‚ÇÇ"], correct: "C‚ÇÇH‚ÇÖNH‚ÇÇ" },
  { q: "Dimethylamine c√≥ c√¥ng th·ª©c c·∫•u t·∫°o l√†", options: ["(CH‚ÇÉ)‚ÇÉN", "CH‚ÇÉNH‚ÇÇ", "CH‚ÇÉNHCH‚ÇÉ", "C‚ÇÇH‚ÇÖNH‚ÇÇ"], correct: "CH‚ÇÉNHCH‚ÇÉ" },
  { q: "C√¥ng th·ª©c ph√¢n t·ª≠ c·ªßa trimethylamine l√†", options: ["C‚ÇÉH‚ÇáN", "C‚ÇÉH‚ÇâN", "C‚ÇÇH‚ÇáN", "CH‚ÇÖN"], correct: "C‚ÇÉH‚ÇâN" },
  { q: "C√¥ng th·ª©c t·ªïng qu√°t c·ªßa amine no, ƒë∆°n ch·ª©c, m·∫°ch h·ªü l√†", options: ["CnH‚ÇÇn+‚ÇÉN (n ‚â• 1)", "CnH‚ÇÇn+‚ÇÇN (n ‚â• 1)", "CnH‚ÇÇnN (n ‚â• 1)", "CnH‚ÇÇn+‚ÇÅN (n ‚â• 1)"], correct: "CnH‚ÇÇn+‚ÇÉN (n ‚â• 1)" },
  { q: "T√™n thay th·∫ø c·ªßa amine CH‚ÇÉ-CH(CH‚ÇÉ)-NH‚ÇÇ l√†", options: ["propan-2-amine", "propylamine", "propan-1-amine", "isopropylamine"], correct: "propan-2-amine" },
  { q: "Dung d·ªãch ch·∫•t n√†o sau ƒë√¢y l√†m xanh gi·∫•y qu·ª≥ t√≠m?", options: ["CH‚ÇÉCOOH", "HCl", "C‚ÇÜH‚ÇÖNH‚ÇÇ (aniline)", "C‚ÇÇH‚ÇÖNH‚ÇÇ"], correct: "C‚ÇÇH‚ÇÖNH‚ÇÇ" },
  { q: "C√¥ng th·ª©c c·∫•u t·∫°o thu g·ªçn c·ªßa aniline l√†", options: ["C‚ÇÇH‚ÇÖNH‚ÇÇ", "CH‚ÇÉNH‚ÇÇ", "C‚ÇÜH‚ÇÖCH‚ÇÇNH‚ÇÇ", "C‚ÇÜH‚ÇÖNH‚ÇÇ"], correct: "C‚ÇÜH‚ÇÖNH‚ÇÇ" },
  { q: "Khi th·∫ø thay th·∫ø nguy√™n t·ª≠ hydrogen trong ammonia b·∫±ng g·ªëc hydrocarbon ta thu ƒë∆∞·ª£c h·ª£p ch·∫•t n√†o sau ƒë√¢y?", options: ["Carbohydrate", "Ester", "Amine", "Carboxylic acid"], correct: "Amine" },
  { q: "S·ªë ƒë·ªìng ph√¢n amine ·ª©ng v·ªõi c√¥ng th·ª©c ph√¢n t·ª≠ C‚ÇÉH‚ÇâN l√†", options: ["2", "4", "5", "3"], correct: "4" },
  { q: "D√£y g·ªìm c√°c ch·∫•t ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª± gi·∫£m d·∫ßn l·ª±c base t·ª´ tr√°i sang ph·∫£i l√†", options: ["Ethylamine, ammonia, phenylamine", "Phenylamine, ammonia, ethylamine"], correct: "Ethylamine, ammonia, phenylamine" },
  { q: "Trong c√°c ch·∫•t d∆∞·ªõi ƒë√¢y, ch·∫•t n√†o l√† amine b·∫≠c m·ªôt?", options: ["C‚ÇÇH‚ÇÖNHCH‚ÇÉ", "(CH‚ÇÉ)‚ÇÉN", "CH‚ÇÉCH‚ÇÇNH‚ÇÇ", "CH‚ÇÉNHCH‚ÇÉ"], correct: "CH‚ÇÉCH‚ÇÇNH‚ÇÇ" },
  { q: "Nh·ªè v√†i gi·ªçt dung d·ªãch phenolphtalein v√†o dung d·ªãch methylamine th·∫•y dung d·ªãch chuy·ªÉn sang m√†u", options: ["ƒë·ªè", "t√≠m", "xanh", "h·ªìng"], correct: "h·ªìng" }
];

// H√†m x√°o tr·ªôn
function shuffle(array) {
  let arr = [...array];
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

// L·∫•y s·ªë l·∫ßn truy c·∫≠p t·ª´ localStorage
let visitCount = parseInt(localStorage.getItem('amineQuizVisit') || '0') + 1;
localStorage.setItem('amineQuizVisit', visitCount);

// L·∫•y ch·∫ø ƒë·ªô t·ª´ localStorage (m·∫∑c ƒë·ªãnh: fixed)
let mode = localStorage.getItem('amineQuizMode') || 'fixed';

// N·∫øu ng∆∞·ªùi d√πng t·ª´ng ch·ªçn random th√¨ ∆∞u ti√™n theo ƒë√≥, c√≤n kh√¥ng th√¨ 3 l·∫ßn ƒë·∫ßu fixed
if (visitCount <= 3 && mode !== 'random') {
  mode = 'fixed';
}

let currentQuestions = mode === 'random' ? shuffle(originalQuestions) : [...originalQuestions];

// Render c√¢u h·ªèi
const quizDiv = document.getElementById("quiz");
currentQuestions.forEach((item, index) => {
  const qNum = index + 1;
  const questionDiv = document.createElement("div");
  questionDiv.className = "question";
  questionDiv.innerHTML = `
    <h3>C√¢u ${qNum}: ${item.q}</h3>
    <div class="options">
      ${item.options.map(opt => `
        <label>
          <input type="radio" name="q${qNum}" value="${opt}">
          ${opt}
        </label>
      `).join('')}
    </div>
  `;
  quizDiv.appendChild(questionDiv);
});

// C·∫≠p nh·∫≠t tr·∫°ng th√°i
const statusEl = document.getElementById("status");
const fixedBtn = document.getElementById("fixedBtn");
const randomBtn = document.getElementById("randomBtn");

function updateMode(newMode) {
  mode = newMode;
  localStorage.setItem('amineQuizMode', mode);
  statusEl.textContent = mode === 'random' 
    ? "ƒêang ·ªü ch·∫ø ƒë·ªô: X√°o tr·ªôn ƒë·ªÅ" 
    : "ƒêang ·ªü ch·∫ø ƒë·ªô: Gi·ªØ nguy√™n th·ª© t·ª±";
  fixedBtn.classList.toggle("active", mode === 'fixed');
  randomBtn.classList.toggle("active", mode === 'random');
}

updateMode(mode);

// N√∫t chuy·ªÉn ch·∫ø ƒë·ªô
fixedBtn.onclick = () => {
  if (mode !== 'fixed') {
    updateMode('fixed');
    alert("L·∫ßn sau reload trang s·∫Ω gi·ªØ nguy√™n th·ª© t·ª± nh√©!");
  }
};

randomBtn.onclick = () => {
  if (mode !== 'random') {
    updateMode('random');
    alert("L·∫ßn sau reload trang s·∫Ω x√°o tr·ªôn ƒë·ªÅ nh√©!");
  }
};

// Ch·∫•m b√†i (gi·ªØ nguy√™n logic c≈©)
function submitQuiz() {
  let score = 0;
  let resultHTML = `<h2 style="text-align:center;">K·∫æT QU·∫¢ B√ÄI L√ÄM</h2><div class="detail">`;

  currentQuestions.forEach((item, index) => {
    const qNum = index + 1;
    const selected = document.querySelector(`input[name="q${qNum}"]:checked`);
    const userAnswer = selected ? selected.value : null;
    const correctAnswer = item.correct;

    // X√≥a highlight c≈©
    document.querySelectorAll(`.question:nth-child(${qNum}) .options label`).forEach(label => {
      label.classList.remove("correct-selected", "wrong-selected");
    });

    if (userAnswer === correctAnswer) {
      score++;
      resultHTML += `<p style="color:#d4edda;">C√¢u ${qNum}: ƒê√∫ng ‚úì</p>`;
      if (selected) selected.parentElement.classList.add("correct-selected");
    } else {
      if (selected) selected.parentElement.classList.add("wrong-selected");
      const correctRadio = document.querySelector(`input[name="q${qNum}"][value="${correctAnswer}"]`);
      if (correctRadio) {
        correctRadio.checked = true;
        correctRadio.parentElement.classList.add("correct-selected");
      }
      resultHTML += `<p style="color:#f8d7da;">C√¢u ${qNum}: Sai ‚úó<br>‚Üí ƒê√°p √°n ƒë√∫ng l√†: <strong>${correctAnswer}</strong></p>`;
    }
  });

  resultHTML += `</div><h2 style="margin-top:40px;">T·ªïng ƒëi·ªÉm: ${score}/25</h2>`;
  if (score === 25) resultHTML += "<p>Full ƒëi·ªÉm th·∫ßn th√°nh! üî•üî•</p>";
  else if (score >= 20) resultHTML += "<p>Pro v√£i bro! üëë</p>";
  else if (score >= 15) resultHTML += "<p>Kh√° t·ªët r·ªìi, ti·∫øp t·ª•c ph√°t huy! üëç</p>";
  else resultHTML += "<p>C·ªë l√™n l·∫ßn sau nha! üí™</p>";

  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = resultHTML;
  resultDiv.style.display = "block";
  resultDiv.style.background = score >= 20 ? "#2ecc71" : score >= 15 ? "#f39c12" : "#e74c3c";

  window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
}
</script>
</body>
</html>
